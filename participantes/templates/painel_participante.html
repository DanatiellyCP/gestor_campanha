{% extends "base_2.html" %}
{% load static %}

{% block title %}Painel do Participante{% endblock %}

{% block content %}
  {% include 'includes/header_basico.html' %}
  
  <div style="font-family: Segoe UI; color: #263A7C; text-align:center;font-weight:bold;font-size:40px">
    <h1>Painel do participante</h1>
  </div>
  <div style="font-family: Segoe UI; color: #263A7C; text-align:center;font-weight:bold;font-size:20px">
    <p>Bem vindo de volta! {{ participante.nome }}</p>
  </div>

  <!-- Container Principal -->
  <div class="container-fluid py-8" style="width: 100%;">
    <div class="justify-content-center align-items-center gx-4">

      <!-- Card: Seus Dados -->
      <div class="row justify-content-center">
        <div class="card" style="width:70%; margin:1%;">
          <div class="card-header bg-primary text-white">
            Seus dados
          </div>
          <div class="card-body">
            <form action="{% url 'editar_particip' participante.id %}" method="POST">
              {% csrf_token %}
              
              <div class="form-group mb-2">
                <label>Nome:</label>
                <input type="text" name="nome" value="{{ participante.nome }}" class="form-control">
              </div>

              <div class="form-group mb-2">
                <label>CPF:</label>
                <input type="text" name="cpf" value="{{ participante.cpf }}" class="form-control" readonly>
              </div>

              <div class="form-group mb-2">
                <label>E-mail:</label>
                <input type="email" name="email" value="{{ participante.email }}" class="form-control">
              </div>

              <div class="form-group">
                <label>Celular:</label>
                <input type="text" name="celular" value="{{ participante.celular }}" class="form-control">
              </div>

              <button type="submit" class="btn btn-warning mt-3" style="width: 100%;">Salvar alterações</button>
            </form>   
          </div>
        </div>
      </div>
      
      <!-- Card: Ações -->
      <div class="row justify-content-center">
        <div class="card" style="width: 70%; margin:2%;">
          <div class="card-header bg-primary text-white">
            Ações
          </div>
          <div class="card-body">
            <p style="margin:4px;">
              <a href="#" class="btn btn-info" style="width:100%;">
                Informações sobre os sorteios
              </a>
            </p>
            <p style="margin:4px;">
              <!-- CORREÇÃO: Adicionado o namespace 'cupons:' para resolver o NoReverseMatch -->
              <a href="{% url 'cadastrar_cupom' participante.id %}" class="btn btn-danger" style="width:100%;">
                Cadastrar Cupom
              </a>
            </p>
            <p style="margin:4px;">
              <a href="#" class="btn btn-warning" style="width:100%;">
                Mudar Senha
              </a>
            </p>
          </div>
        </div>
      </div>

      <!-- Card: Cupons Cadastrados -->
      <div class="row justify-content-center">
        <div class="card" style="width: 70%; margin:2%;">
          <div class="card-header bg-primary text-white">
            Cupons Cadastrados
          </div>
          <div style="height: 200px; overflow-y: auto;">
            <div class="card-body">
              <table class="table table-striped">
                <thead>
                  <tr>
                    <th>Status</th>
                    <th>Data</th>
                    <th>Hora</th>
                    <th>Tipo</th>
                    <th>Detalhar</th>
                  </tr>
                </thead>
                <tbody>
                  {% for cupom in cupons %}
                  <tr>
                    <td>{{ cupom.status }}</td>
                    <td>{{ cupom.data_cadastro|date:"d/m/Y" }}</td>
                    <td>{{ cupom.hora_cadastro }}</td>
                    <td>{{ cupom.tipo_documento }}</td>
                    <td>  
                      <a href="{% url 'area_cupom' cupom.id %}" class="btn btn-light">
                        <img src="{% static 'imgs_sistema/detalhe2.ico' %}" alt="Detalhar cupom {{ cupom.id }}" style="width:30px; height:30px;">
                      </a>
                    </td>
                  </tr>
                  {% empty %}
                  <tr>
                    <td colspan="4" class="text-center">Nenhum cupom cadastrado ainda.</td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      
    </div>
  </div>
{% endblock %}