{% load static %}
<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Promoção Bombril - Home</title>
    <meta name="description"
        content="Participe da promoção Bombril e concorra a prêmios incríveis. Cadastre seus cupons e dê um brilho no seu futuro!">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <script src="https://kit.fontawesome.com/f0d3945d17.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://use.typekit.net/nnt2jwc.css">

    <link rel="icon" type="image/png" href="{% static 'responsive/images/Favicon.png' %}">
    <link rel="stylesheet" href="{% static 'responsive/menu.css' %}?v=2025-08-13-1">
</head>
<body>
  <div class="wrap">
    <header class="menu" role="navigation" aria-label="Principal">
      <div class="bar">
        <a class="brand" href="#" aria-label="Página inicial">
          <img src="{% static 'responsive/images/LOGO_BOMBRIL.png' %}" alt="Bombril" />
        </a>
        <nav aria-label="Seções">
          <ul class="links">
            <li><a href="{% url 'painel_home' %}">Inicio</a></li>
            <li><a target="_blank" href="{% url 'lista_resultado' %}">Sorteios</a></li>
            <li><a href="{% url 'painel_cadastrar_cupom' %}">Cadastrar cupons</a></li>
            <li><a href="{% url 'painel_home' %}">Editar perfil</a></li>
          </ul>
        </nav>
        <div class="actions">
          <a href="{% url 'logout' %}" class="btn btn-participe" id="ctaParticipar">SAIR</a>
        </div>
        <button class="hamb" id="hamb" aria-label="Abrir menu" aria-expanded="false" aria-controls="drawer">
          <span></span><span></span><span></span>
        </button>
      </div>
      <div class="drawer" id="drawer">
        <ul class="links">
          <br/>
          <li><a href="/painel-home/">Inicio</a></li>
          <li><a target="_blank" href="/lista-resultados/">Sorteios</a></li>
          <li><a href="/painel-cadastrar-cupom/">Cadastrar cupons</a></li>
          <li><a href="/painel-home/">Editar perfil</a></li>
        </ul>
        <div class="actions">
          <a href="{% url 'logout' %}" class="btn btn-participe" id="mParticipar">SAIR</a>
        </div>
      </div>
    </header>
  </div>

  <div class="topo panel-hero" role="img" aria-label="Topo do site">
    <img src="{% static 'responsive/images/background_topo.png' %}" alt="" class="topo-measure" aria-hidden="true" />
    <div class="inner">
      <h1 class="sr-only">Painel</h1>
      <div class="panel-duo" aria-hidden="true">
        <img src="{% static 'responsive/images/PRODUTOS.png' %}" alt="" class="panel-logo" />
        <img src="{% static 'responsive/images/painel_promocao.png' %}" alt="" class="panel-side" />
      </div>
      <img src="{% static 'responsive/images/ROBOM-BRIL_NAVE.png' %}" alt="" class="topo-robot" aria-hidden="true" />
    </div>
  </div>
  <div id="content">
    <section class="participant-panel" aria-label="Painel do participante">
      <div class="inner">
        <header class="panel-header">
          <h2 class="panel-title">Painel do participante</h2>
          <p class="panel-sub">Bem-vindo de volta, {{ participante.nome }}</p>
        </header>

        <section class="panel-coupons" aria-label="Seus cupons cadastrados">
          <h3 class="section-title">Seus cupons cadastrados</h3>
          <div class="table-responsive">
            <table class="coupons-table" role="table">
              <thead>
                <tr>
                  <th scope="col">Status</th>
                  <th scope="col">Data</th>
                  <th scope="col">Hora</th>
                  <th scope="col">Detalhar</th>
                </tr>
              </thead>
              <tbody>
                {% if cupons_participantes %}
                  {% for cupom in cupons_participantes %}
                    <tr>
                      <td data-label="Status"><span class="badge {% if cupom.status == 'Validado' %}status-ok{% elif cupom.status == 'Pendente' %}status-wait{% else %}status-bad{% endif %}">{{ cupom.status }}</span></td>
                      <td data-label="Data">{{ cupom.data_cadastro|date:"d/m/Y" }}</td>
                      <td data-label="Hora">{{ cupom.hora_cadastro|time:"H:i" }}</td>
                      <td data-label="Detalhar" class="detail">
                        <a href="{% url 'painel_detalhes_cupom' %}?id={{ cupom.id }}"><i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i> Exibir</a>
                        {% if cupom.status == 'Pendente' or cupom.status == 'Invalidado' %}
                          &nbsp;|&nbsp;
                          <button type="button" class="link-delete" data-cupom-id="{{ cupom.id }}" aria-haspopup="dialog">
                            <i class="fa-solid fa-trash" aria-hidden="true"></i> Excluir
                          </button>
                        {% endif %}
                      </td>
                    </tr>
                  {% endfor %}
                {% else %}
                  <tr>
                    <td colspan="4" style="text-align:center;">Você ainda não cadastrou nenhum cupom.</td>
                  </tr>
                {% endif %}
              </tbody>
            </table>
          </div>
        </section>

        <section class="panel-data" aria-label="Seus dados">
          <h3 class="band-title">Seus dados</h3>
          <form class="panel-form" action="{% url 'painel_home' %}" method="post">
            {% csrf_token %}
            <label class="field">
              <span class="label">Nome:</span>
              <input type="text" name="nome" value="{{ participante.nome }}" />
            </label>
            <label class="field">
              <span class="label">CPF:</span>
              <input type="text" name="cpf" value="{{ participante.cpf }}" />
            </label>
            <label class="field">
              <span class="label">e-mail:</span>
              <input type="email" name="email" value="{{ participante.email }}" />
            </label>
            <label class="field">
              <span class="label">Celular:</span>
              <input type="text" name="celular" value="{{ participante.celular }}" />
            </label>
            <div class="form-actions">
              <button type="submit" class="btn-save">Salvar alterações</button>
            </div>
            {% if salvo %}
              <p class="save-success" role="status">Dados atualizados com sucesso.</p>
            {% endif %}
          </form>
        </section>
      </div>
    </section>
  </div>
  <footer class="footer">
    <div class="inner">
      <div class="footer-top">
        <h2 class="footer-title">É MAIS DO QUE BOM. É DA</h2>
        <img class="footer-logo" src="{% static 'responsive/images/LOGO_BOMBRIL.png' %}" alt="Bombril" />
      </div>
      <ul class="footer-links">
        <li><a target="_blank" href="https://ri.bombril.com.br/termos-e-condicoes-de-uso">Termos de uso</a></li>
        <li><a target="_blank" href="https://www.bombril.com.br/politica-de-privacidade">Política de privacidade</a></li>
        <li><a target="_blank" href="https://www.bombril.com.br/politica-de-privacidade">LGPD</a></li>
      </ul>
      <p class="footer-legal">
        PARTICIPAÇÃO: DE 15/08/2025 ÀS 23H59 DE 15/10/2025. SORTEIOS: 20/08/2025, 23/08/2025, 27/08/2025, 30/08/2025, 03/09/2025, 06/09/2025, 10/09/2025, 13/09/2025, 17/09/2025, 20/09/2025, 24/09/2025, 27/09/2025, 01/10/2025, 04/10/2025, 08/10/2025, 11/10/2025, 15/10/2025 e 18/10/2025 PELO RESULTADO DA LOTERIA FEDERAL. PROMOÇÃO VÁLIDA PARA MAIORES DE 18 ANOS. LIMITE DE 3 NÚMEROS DA SORTE POR CUPOM FISCAL CADASTRADO. CONSULTE REGULAMENTO COM Nº DO CERTIFICADO DE AUTORIZAÇÃO SPA/MF EM WWW.PROMOCAOBOMBRIL.COM.BR. *SUGESTÃO DE PRÊMIO. A PREMIAÇÃO SERÁ ENTREGUE EM CARTEIRA DIGITAL, SEM FUNÇÃO SAQUE E TRANSFERÊNCIA, CONFORME REGULAMENTO.
      </p>
      <p class="footer-legal">
        Em caso de dúvidas, entre em contato com nosso SAC:<br/>

        E-mail: faleconosco@promocaobombril.com.br<br/>

        Telefone: 0800 7076161
      </p>
    </div>
  </footer>

  <!-- Privacy/Cookie banner -->
  <div class="cookie-banner" id="cookieBanner" role="region" aria-label="Aviso de cookies e privacidade">
    <div class="cookie-inner">
      <p class="cookie-text">Utilizamos cookies para otimizar sua experiência em nosso site. Ao continuar a navegação, você concorda com a nossa <a href="/privacidade" target="_blank" rel="noopener">Política de Privacidade</a>.</p>
      <button class="cookie-accept" id="cookieAccept">ACEITAR E FECHAR</button>
    </div>
   </div>
  <script src="{% static 'responsive/menu.js' %}?v=2025-08-13-1"></script>
  <style>
    .modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;z-index:1000}
    .modal{background:#fff;border-radius:8px;max-width:420px;width:90%;padding:20px;box-shadow:0 10px 30px rgba(0,0,0,.2)}
    .modal h4{margin:0 0 10px 0;color:#263A7C}
    .modal .actions{display:flex;gap:10px;justify-content:flex-end;margin-top:16px}
    .btn-cancel{background:#e0e0e0;border:none;padding:8px 14px;border-radius:6px;cursor:pointer}
    .btn-confirm{background:#c0392b;color:#fff;border:none;padding:8px 14px;border-radius:6px;cursor:pointer}
    .detail .link-delete{background:none;border:none;color:#c0392b;cursor:pointer;font:inherit;padding:0}
    .detail .link-delete i{margin-right:4px}
  </style>
  <div class="modal-overlay" id="deleteModal" role="dialog" aria-modal="true" aria-labelledby="deleteTitle">
    <div class="modal">
      <h4 id="deleteTitle">Confirmar exclusão</h4>
      <p>Tem certeza que deseja excluir este cupom? Esta ação não pode ser desfeita.</p>
      <form id="deleteForm" method="post">
        {% csrf_token %}
        <div class="actions">
          <button type="button" class="btn-cancel" id="cancelDelete">Cancelar</button>
          <button type="submit" class="btn-confirm">Excluir</button>
        </div>
      </form>
    </div>
  </div>
  <script>
    (function(){
      const modal = document.getElementById('deleteModal');
      const form = document.getElementById('deleteForm');
      const cancelBtn = document.getElementById('cancelDelete');
      function openModal(cupomId){
        // Define action para endpoint de exclusão
        form.action = '/excluir-cupom/' + cupomId + '/';
        modal.style.display = 'flex';
      }
      function closeModal(){ modal.style.display = 'none'; }
      document.addEventListener('click', function(e){
        const btn = e.target.closest('.link-delete');
        if(btn){
          const id = btn.getAttribute('data-cupom-id');
          if(id){ openModal(id); }
        }
      });
      cancelBtn.addEventListener('click', closeModal);
      modal.addEventListener('click', function(e){ if(e.target === modal){ closeModal(); } });
      document.addEventListener('keydown', function(e){ if(e.key === 'Escape'){ closeModal(); } });
    })();
  </script>
</body>
</html>
