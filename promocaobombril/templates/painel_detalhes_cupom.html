{% load static %}
<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Promoção Bombril - Home</title>
    <meta name="description"
        content="Participe da promoção Bombril e concorra a prêmios incríveis. Cadastre seus cupons e dê um brilho no seu futuro!">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <script src="https://kit.fontawesome.com/f0d3945d17.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://use.typekit.net/nnt2jwc.css">

    <link rel="icon" type="image/png" href="{% static 'responsive/images/Favicon.png' %}">
    <link rel="stylesheet" href="{% static 'responsive/menu.css' %}?v=2025-08-13-1">
</head>
<body>
  <div class="wrap">
    <header class="menu" role="navigation" aria-label="Principal">
        <div class="bar">
          <a class="brand" href="#" aria-label="Página inicial">
            <img src="{% static 'responsive/images/LOGO_BOMBRIL.png' %}" alt="Bombril" />
          </a>
          <nav aria-label="Seções">
            <ul class="links">
              <li><a href="{% url 'painel_home' %}">Inicio</a></li>
              <li><a target="_blank" href="{% url 'lista_resultado' %}">Sorteios</a></li>
              <li><a href="{% url 'painel_cadastrar_cupom' %}">Cadastrar cupons</a></li>
              <li><a href="{% url 'painel_home' %}">Editar perfil</a></li>
            </ul>
          </nav>
          <div class="actions">
            <a href="{% url 'logout' %}" class="btn btn-participe" id="ctaParticipar">SAIR</a>
          </div>
          <button class="hamb" id="hamb" aria-label="Abrir menu" aria-expanded="false" aria-controls="drawer">
            <span></span><span></span><span></span>
          </button>
        </div>
        <div class="drawer" id="drawer">
          <ul class="links">
            <br/>
            <li><a href="/painel-home/">Inicio</a></li>
            <li><a target="_blank" href="/lista-resultados/">Sorteios</a></li>
            <li><a href="/painel-cadastrar-cupom/">Cadastrar cupons</a></li>
            <li><a href="/painel-home/">Editar perfil</a></li>
          </ul>
          <div class="actions">
            <a href="{% url 'logout' %}" class="btn btn-participe" id="mParticipar">SAIR</a>
          </div>
        </div>
      </header>
  </div>

  <div class="topo panel-hero" role="img" aria-label="Topo do site">
    <img src="{% static 'responsive/images/background_topo.png' %}" alt="" class="topo-measure" aria-hidden="true" />
    <div class="inner">
      <h1 class="sr-only">Painel</h1>
      <div class="panel-duo" aria-hidden="true">
        <img src="{% static 'responsive/images/PRODUTOS.png' %}" alt="" class="panel-logo" />
        <img src="{% static 'responsive/images/painel_promocao.png' %}" alt="" class="panel-side" />
      </div>
      <img src="{% static 'responsive/images/ROBOM-BRIL_NAVE.png' %}" alt="" class="topo-robot" aria-hidden="true" />
    </div>
  </div>
  <div id="content">
    <section class="participant-panel" aria-label="Painel do participante">
      <div class="inner">
        <header class="panel-header">
          <h2 class="panel-title">Detalhes do Cupom</h2>
        </header>
        <div class="status-banner">
          <span class="badge {% if cupom.status == 'Validado' %}status-ok{% elif cupom.status == 'Pendente' %}status-wait{% else %}status-bad{% endif %}">{{ cupom.status }}</span>
          {% if cupom.status == 'Pendente' %}
            <div class="pending-note">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              Seu cupom está em análise. Aguarde a conclusão da validação.
            </div>
          {% endif %}
        </div>

        <div class="coupon-details">
          <div class="details-container">
            <!-- Coluna 1: Dados do Cupom -->
            <div class="coupon-info">
              <h3 class="section-title">Dados do Cupom Fiscal</h3>
              <div class="info-grid">
                <div class="info-item">
                  <span class="info-label">Loja:</span>
                  <span class="info-value">
                    {% if dados_extra and dados_extra.emitente and dados_extra.emitente.nome %}
                      {{ dados_extra.emitente.nome }}
                    {% elif dados_extra and dados_extra.data and dados_extra.data.0 and dados_extra.data.0.emitente and dados_extra.data.0.emitente.nome_razao_social %}
                      {{ dados_extra.data.0.emitente.nome_razao_social }}
                    {% else %}
                      {{ cupom.nome_loja }}
                    {% endif %}
                  </span>
                </div>
                <div class="info-item">
                  <span class="info-label">CNPJ:</span>
                  <span class="info-value">
                    {% if dados_extra and dados_extra.emitente and dados_extra.emitente.cnpj %}
                      {{ dados_extra.emitente.cnpj }}
                    {% elif dados_extra and dados_extra.data and dados_extra.data.0 and dados_extra.data.0.emitente and dados_extra.data.0.emitente.cnpj %}
                      {{ dados_extra.data.0.emitente.cnpj }}
                    {% else %}
                      {{ cupom.cnpj_loja }}
                    {% endif %}
                  </span>
                </div>
                <div class="info-item">
                  <span class="info-label">Documento:</span>
                  <span class="info-value">{{ cupom.tipo_documento }}</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Número/Chave:</span>
                  <span class="info-value">
                    {% if dados_extra and dados_extra.chave_acesso %}
                      {{ dados_extra.chave_acesso }}
                    {% elif dados_extra and dados_extra.nfe and dados_extra.nfe.chave_acesso %}
                      {{ dados_extra.nfe.chave_acesso }}
                    {% elif dados_extra and dados_extra.data and dados_extra.data.0 and dados_extra.data.0.informacoes_nota and dados_extra.data.0.informacoes_nota.chave_acesso %}
                      {{ dados_extra.data.0.informacoes_nota.chave_acesso }}
                    {% else %}
                      {{ cupom.numero_documento }}
                    {% endif %}
                  </span>
                </div>
                <div class="info-item">
                  <span class="info-label">Status:</span>
                  <span class="info-value">{{ cupom.status }}</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Cadastro:</span>
                  <span class="info-value">{{ cupom.data_cadastro|date:"d/m/Y" }} {{ cupom.hora_cadastro|time:"H:i" }}</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Total:</span>
                  <span class="info-value">
                    {% if dados_extra and dados_extra.nfe and dados_extra.nfe.valor_total %}
                      R$ {{ dados_extra.nfe.valor_total }}
                    {% elif dados_extra and dados_extra.total %}
                      R$ {{ dados_extra.total }}
                    {% elif dados_extra and dados_extra.data and dados_extra.data.0 %}
                      {% with d0=dados_extra.data.0 %}
                        {% if d0.normalizado_valor_a_pagar %}
                          R$ {{ d0.normalizado_valor_a_pagar }}
                        {% elif d0.valor_a_pagar %}
                          R$ {{ d0.valor_a_pagar }}
                        {% elif d0.normalizado_valor_total %}
                          R$ {{ d0.normalizado_valor_total }}
                        {% elif d0.valor_total %}
                          R$ {{ d0.valor_total }}
                        {% else %}-{% endif %}
                      {% endwith %}
                    {% elif cupom.valor_total %}
                      R$ {{ cupom.valor_total }}
                    {% else %}-{% endif %}
                  </span>
                </div>
              </div>
            </div>

            <!-- Coluna 2: Lista de Produtos -->
            <div class="products-list" style="max-height: 50vh; overflow-y: auto; overscroll-behavior: contain; padding-right: 8px;">
              <h3 class="section-title">Produtos Elegíveis</h3>
              <div class="products-container">
                {% if dados_extra and dados_extra.data and dados_extra.data.0 and dados_extra.data.0.produtos %}
                  {% for p in dados_extra.data.0.produtos %}
                  <div class="product-item">
                    <div class="product-name">{{ p.nome }}</div>
                    <div class="product-details">
                      <span>Qtd: {{ p.qtd|default:p.quantidade|default:p.normalizado_quantidade }}</span>
                      <span>R$ {{ p.valor_unitario|default:p.normalizado_valor_unitario }}</span>
                      <span>R$ {{ p.valor_total_item|default:p.valor_total|default:p.valor_total_produto|default:p.normalizado_valor_total_produto }}</span>
                    </div>
                  </div>
                  {% endfor %}
                {% elif dados_extra and dados_extra.produtos %}
                  {% for p in dados_extra.produtos %}
                  <div class="product-item">
                    <div class="product-name">{{ p.nome }}</div>
                    <div class="product-details">
                      <span>Qtd: {{ p.qtd|default:p.quantidade }}</span>
                      <span>R$ {{ p.valor_unitario }}</span>
                      <span>R$ {{ p.valor_total_item|default:p.valor_total }}</span>
                    </div>
                  </div>
                  {% endfor %}
                {% elif produtos %}
                  {% for p in produtos %}
                  <div class="product-item">
                    <div class="product-name">{{ p.nome }}</div>
                    <div class="product-details">
                      <span>Qtd: {{ p.qtd|default:p.quantidade }}</span>
                      <span>R$ {{ p.valor_unitario }}</span>
                      <span>R$ {{ p.valor_total_item|default:p.valor_total }}</span>
                    </div>
                  </div>
                  {% endfor %}
                {% else %}
                  <p>Nenhum produto registrado para este cupom.</p>
                {% endif %}
              </div>
            </div>
          </div>

          <!-- Tabela de Produtos e Números da Sorte -->
          <div class="table-responsive">
            <h3 class="section-title">Números da Sorte Gerados</h3>
            <table class="coupons-table" role="table">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Número da Sorte</th>
                </tr>
              </thead>
              <tbody>
                {% if numeros %}
                  {% for n in numeros %}
                  <tr>
                    <td>{{ forloop.counter }}</td>
                    <td>{{ n }}</td>
                  </tr>
                  {% endfor %}
                {% else %}
                  <tr>
                    <td colspan="2" style="text-align:center;">Nenhum número da sorte gerado.</td>
                  </tr>
                {% endif %}
              </tbody>
            </table>
          </div>

          <section class="panel-data" aria-label="Seus dados">
            <h3 class="band-title">Você gerou esse(s) número(s) da sorte:
              <br/><br/>
              {% if numeros %}
                {% for n in numeros %}
                  {{ n }}{% if not forloop.last %}, {% endif %}
                {% endfor %}
              {% else %}
                Nenhum número gerado.
              {% endif %}
              <br/><br/>
              <div class="action-buttons">
                <a href="/painel-home/" style="text-decoration: none; width: 400px;" class="btn btn-yellow" id="back3">< Voltar</a>
              </div>
            </h3>
          </section>

        </div>
      </div>
    </section>
  </div>
  <footer class="footer">
    <div class="inner">
      <div class="footer-top">
        <h2 class="footer-title">É MAIS DO QUE BOM. É DA</h2>
        <img class="footer-logo" src="{% static 'responsive/images/LOGO_BOMBRIL.png' %}" alt="Bombril" />
      </div>
      <ul class="footer-links">
        <li><a target="_blank" href="https://ri.bombril.com.br/termos-e-condicoes-de-uso">Termos de uso</a></li>
        <li><a target="_blank" href="https://www.bombril.com.br/politica-de-privacidade">Política de privacidade</a></li>
        <li><a target="_blank" href="https://www.bombril.com.br/politica-de-privacidade">LGPD</a></li>
      </ul>
      <p class="footer-legal">
        PARTICIPAÇÃO: DE 15/08/2025 ÀS 23H59 DE 15/10/2025. SORTEIOS: 20/08/2025, 23/08/2025, 27/08/2025, 30/08/2025, 03/09/2025, 06/09/2025, 10/09/2025, 13/09/2025, 17/09/2025, 20/09/2025, 24/09/2025, 27/09/2025, 01/10/2025, 04/10/2025, 08/10/2025, 11/10/2025, 15/10/2025 e 18/10/2025 PELO RESULTADO DA LOTERIA FEDERAL. PROMOÇÃO VÁLIDA PARA MAIORES DE 18 ANOS. LIMITE DE 3 NÚMEROS DA SORTE POR CUPOM FISCAL CADASTRADO. CONSULTE REGULAMENTO COM Nº DO CERTIFICADO DE AUTORIZAÇÃO SPA/MF EM WWW.PROMOCAOBOMBRIL.COM.BR. *SUGESTÃO DE PRÊMIO. A PREMIAÇÃO SERÁ ENTREGUE EM CARTEIRA DIGITAL, SEM FUNÇÃO SAQUE E TRANSFERÊNCIA, CONFORME REGULAMENTO.
      </p>
      <p class="footer-legal">
        Em caso de dúvidas, entre em contato com nosso SAC:<br/>

        E-mail: faleconosco@promocaobombril.com.br<br/>

        Telefone: 0800 7076161
      </p>
    </div>
  </footer>

  <!-- Privacy/Cookie banner -->
  <div class="cookie-banner" id="cookieBanner" role="region" aria-label="Aviso de cookies e privacidade">
    <div class="cookie-inner">
      <p class="cookie-text">Utilizamos cookies para otimizar sua experiência em nosso site. Ao continuar a navegação, você concorda com a nossa <a href="/privacidade" target="_blank" rel="noopener">Política de Privacidade</a>.</p>
      <button class="cookie-accept" id="cookieAccept">ACEITAR E FECHAR</button>
    </div>
   </div>
  <script src="{% static 'responsive/menu.js' %}?v=2025-08-13-1"></script>
  <style>
    .status-banner{margin:10px 0 20px;display:flex;gap:12px;align-items:center}
    .badge{display:inline-block;padding:6px 10px;border-radius:999px;font-weight:600;font-size:14px}
    .status-ok{background:#e9f7ef;color:#27ae60}
    .status-wait{background:#fff6e5;color:#e67e22}
    .status-bad{background:#fdecea;color:#c0392b}
    .pending-note{font-size:14px;color:#6b7280}
    .pending-note i{margin-right:6px;color:#e67e22}
  </style>
</body>
</html>

